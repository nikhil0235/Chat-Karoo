{"ast":null,"code":"import _slicedToArray from\"C:/Users/NIKHIL RAJPUT/Desktop/Mern chat app/Chat-Karoo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{doc,onSnapshot}from'firebase/firestore';import React,{useEffect,useState}from'react';import{useContext}from'react';import{AuthContext}from'../context/AuthContext';import{ChatContext}from'../context/ChatContext';import{db}from'../firebase';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chats=function Chats(){var _Object$entries;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chats=_useState2[0],setChats=_useState2[1];var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useContext2=useContext(ChatContext),dispatch=_useContext2.dispatch;useEffect(function(){//We are using getChats function because at first we dont have any user chat hence it is giving error\nvar getChats=function getChats(){var unsub=onSnapshot(doc(db,\"usersChat\",currentUser.uid),function(doc){setChats(doc.data());});return function(){unsub();};};//It is Saying if we have currentUser id then we are going to call this function \ncurrentUser.uid&&getChats();},[currentUser.uid]);/* u -> user passed from handleSelect on Click function which includes\n     userInfo like id , image and display Name */var handleSelect=function handleSelect(u){dispatch({type:\"CHANGE_USER\",payload:u});};return/*#__PURE__*/_jsx(\"div\",{className:\"chats\",children:(_Object$entries=Object.entries(chats))===null||_Object$entries===void 0?void 0:_Object$entries.sort(function(a,b){return b[1].date-a[1].date;}).map(function(chat){var _chat$1$lastMessage;return/*#__PURE__*/_jsxs(\"div\",{className:\"userChat\",onClick:function onClick(){return handleSelect(chat[1].userInfo);},children:[/*#__PURE__*/_jsx(\"img\",{src:chat[1].userInfo.photoURL,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"userChatInfo\",children:[/*#__PURE__*/_jsx(\"span\",{children:chat[1].userInfo.displayName}),/*#__PURE__*/_jsx(\"p\",{children:(_chat$1$lastMessage=chat[1].lastMessage)===null||_chat$1$lastMessage===void 0?void 0:_chat$1$lastMessage.text})]})]},chat[0]);})});};export default Chats;","map":{"version":3,"names":["doc","onSnapshot","React","useEffect","useState","useContext","AuthContext","ChatContext","db","jsx","_jsx","jsxs","_jsxs","Chats","_Object$entries","_useState","_useState2","_slicedToArray","chats","setChats","_useContext","currentUser","_useContext2","dispatch","getChats","unsub","uid","data","handleSelect","u","type","payload","className","children","Object","entries","sort","a","b","date","map","chat","_chat$1$lastMessage","onClick","userInfo","src","photoURL","alt","displayName","lastMessage","text"],"sources":["C:/Users/NIKHIL RAJPUT/Desktop/Mern chat app/Chat-Karoo/src/component/Chats.jsx"],"sourcesContent":["import { doc, onSnapshot } from 'firebase/firestore';\nimport React,{useEffect, useState} from 'react'\nimport { useContext } from 'react';\nimport { AuthContext } from '../context/AuthContext';\nimport { ChatContext } from '../context/ChatContext';\nimport { db } from '../firebase';\n\nconst Chats = () => {\n\n\n  const [chats, setChats] = useState([])\n\n  const { currentUser }  = useContext(AuthContext) ;\n  const {dispatch} = useContext(ChatContext);\n\n  useEffect(() => {\n\n    //We are using getChats function because at first we dont have any user chat hence it is giving error\n\nconst getChats =() => {  \n    const unsub = onSnapshot(doc(db, \"usersChat\",currentUser.uid ), (doc) => {\n         \n        setChats(doc.data())\n      \n});  \n\n    return() =>{\n      unsub();\n    };\n  } \n\n\n  //It is Saying if we have currentUser id then we are going to call this function \n     currentUser.uid && getChats()   \n \n  },[currentUser.uid])\n   \n  /* u -> user passed from handleSelect on Click function which includes\n     userInfo like id , image and display Name */\n  const handleSelect = (u) =>{\n      \n      dispatch({type :\"CHANGE_USER\",payload :u})\n  }\n\n  return (\n    <div className='chats'>\n\n      {/*we are converting the currentUser Object to Array and map with the variable chat s\n      so we can access each index of it */}\n\n      {Object.entries(chats)?.sort((a,b)=>b[1].date - a[1].date).map((chat) => (\n     \n      <div className=\"userChat\" key={chat[0]} onClick={()=> handleSelect(chat[1].userInfo)}>\n        <img src={chat[1].userInfo.photoURL} alt=\"\" />\n        <div className=\"userChatInfo\">\n             <span>{chat[1].userInfo.displayName}</span>\n             <p>{chat[1].lastMessage?.text}</p>\n\n             {/*Hence we are sorting the messages  */}\n        </div>\n\n       </div>\n       \n       ))}\n        \n    </div>\n  )\n}\n\nexport default Chats"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}